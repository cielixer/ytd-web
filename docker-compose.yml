services:
  ytd-web:
    build: .
    container_name: ytd-web
    ports:
      - "7893:7893"
    env_file:
      - .env
    environment:
      - NODE_ENV=production
      - TMP_DIR=/tmp/ytd-web
      - YTDLP_AUTO_UPDATE=${YTDLP_AUTO_UPDATE:-true}
      - YTDLP_UPDATE_INTERVAL=${YTDLP_UPDATE_INTERVAL:-6h}
    init: true
    volumes:
      - ytd-tmp:/tmp/ytd-web
    restart: unless-stopped
    # Security: limit resources
    deploy:
      resources:
        limits:
          memory: 512M
          cpus: "1.0"

volumes:
  ytd-tmp:
